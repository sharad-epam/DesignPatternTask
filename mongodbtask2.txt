1. How many records does each airline class have? Use $project to show result as { class: "Z", total: 999 }

 db.airlines.aggregate([{$group:{_id:"$class",count:{$sum:1}}}])

2. What are the top 3 destination cities outside of the United States (destCountry field, not included) with the highest average passengers count? Show result as { "avgPassengers" : 2312.380, "city" : "Minsk, Belarus" }

db.airlines.aggregate([{$match:�{ destCountry:�{$ne:�"United States"}} },{$group:{_id:"$destCity" ,passengers:{$avg:"$passengers"}}}])

3. Which carriers provide flights to Latvia (destCountry)? Show result as one document { "_id" : "Latvia", "carriers" : [ "carrier1", " carrier2", �]

db.airlines.aggregate([{$match:{destCountry:{$eq:"Latvia"}}},{$group:{_id:"destCountry",carriers:{$addToSet:"$carrier"}}}])

4. What are the carriers which flue the most number of passengers from the United State to either Greece, Italy or Spain? Find top 10 carriers, but provide the last 7 carriers (do not include the first 3). Show result as { "_id" : "<carrier>", "total" : 999}

db.airlines.aggregate([{$match:{originCountry:"United States",$or : [{"destCountry" : "Greece"},{"destCountry" : "Spain"},{"destCountry":"Italy"}]}},{$group:{_id:"$carrier" ,passengers:{$sum:"$passengers"}}},{$limit:10},{$skip:3}])

5. Find the city (originCity) with the highest sum of passengers for each state (originState) of the United States (originCountry). Provide the city for the first 5 states ordered by state alphabetically (you should see the city for Alaska, Arizona and etc). Show result as { "totalPassengers" : 999, "location" : { "state" : "abc", "city" : "xyz" } }

db.airlines.aggregate({$match:{originCountry:"United States"}},{$group:{_id:{totalPassengers:{$sum:"$passengers"},location:{state:"$originState",city:"$originCity"}}}},{$sort: {'_id.location.state': 1}},{$limit:5})




